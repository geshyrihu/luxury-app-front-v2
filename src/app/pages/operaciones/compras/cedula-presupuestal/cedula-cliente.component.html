<ng-container *ngIf="data !== null">
  <p-toast position="top-left" [baseZIndex]="99999"></p-toast>

  <div class="card">
    <p-table
      #dt
      [(selection)]="data"
      styleClass="custom-table"
      [value]="data"
      [rowHover]="true"
      currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} registros"
      [showCurrentPageReport]="true"
      [globalFilterFields]="['descripcion']"
    >
      <ng-template pTemplate="caption">
        <app-table-header
          [title]="titulo"
          [showAdd]="true"
          (add)="onModalAdd(data)"
          [dt]="dt"
        ></app-table-header>
        <br />

        <!-- Selecciona Periodo d ecedula -->

        <div class="form-group row">
          <label class="col-sm-2">Buscar prespuesto</label>
          <div class="col-sm-4">
            <select
              class="form-select"
              [(ngModel)]="id"
              (change)="onReloadData($event)"
            >
              <option [value]="item.value" *ngFor="let item of cb_cedulas">
                {{ item.label }}
              </option>
            </select>
          </div>
          <div class="col-sm-2">
            <custom-button
              (clicked)="editarPeriodo(id)"
              customClass=" btn-outline-info"
              label="Editar periodo"
            >
            </custom-button>
          </div>
        </div>

        <!-- Selecciona Periodo d ecedula -->
      </ng-template>

      <ng-template pTemplate="header">
        <tr>
          <th
            scope="col"
            style="width: 10%"
            pSortableColumn="numeroCuenta"
            rowspan="2"
          >
            CUENTA
            <p-sortIcon field="numeroCuenta"></p-sortIcon>
          </th>
          <th
            scope="col"
            style="width: 28%"
            pSortableColumn="descripcion"
            rowspan="2"
          >
            PARTIDA PRESUPUESTAL
            <p-sortIcon field="descripcion"></p-sortIcon>
          </th>
          <th
            scope="col"
            style="width: 13%"
            pSortableColumn="presupuestoMensual"
          >
            MENSUAL
            <p-sortIcon field="presupuestoMensual"></p-sortIcon>
          </th>
          <th
            scope="col"
            field="descripcion"
            style="width: 13%"
            pSortableColumn="presupuestoAnual"
          >
            TOTAL
            <p-sortIcon field="presupuestoAnual"></p-sortIcon>
          </th>
          <th
            scope="col"
            style="width: 13%"
            pSortableColumn="presupuestoEjercido"
          >
            EJERCIDO
            <p-sortIcon field="presupuestoEjercido"></p-sortIcon>
          </th>

          <th
            scope="col"
            style="width: 13%"
            pSortableColumn="presupuestoDisponible"
          >
            DISPONIBLE
            <p-sortIcon field="presupuestoDisponible"></p-sortIcon>
          </th>
          <th style="width: 10%"></th>
        </tr>
        <tr>
          <th scope="col" [ngStyle]="{ backgroundColor: 'var(--blue-300)' }">
            {{ presupuestoMensual }}
            <!-- {{ presupuestoMensual }} -->
          </th>
          <th scope="col" [ngStyle]="{ backgroundColor: 'var(--blue-300)' }">
            {{ presupuestoAnual }}
          </th>
          <th scope="col" [ngStyle]="{ backgroundColor: 'var(--blue-300)' }">
            {{ presupuestoEjercido }}
          </th>

          <th scope="col" [ngStyle]="{ backgroundColor: 'var(--blue-300)' }">
            {{ presupuestoDisponible }}
          </th>
          <th scope="col" [ngStyle]="{ backgroundColor: 'var(--blue-300)' }">
            Opciones
          </th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-item>
        <tr>
          <td class="p-column-title">
            {{ item.numeroCuenta }}
          </td>
          <td class="p-column-title">
            {{ item.descripcion }}
          </td>
          <td class="p-column-title">
            {{ item.presupuestoMensual }}
          </td>
          <td class="p-column-title">
            {{ item.presupuestoAnual }}
          </td>
          <td class="p-column-title">
            {{ item.presupuestoEjercido }}
          </td>

          <td class="p-column-title">
            <div class="w3-container" *ngIf="item.disponible">
              <div class="w3-tag w3-round w3-green" style="padding: 3px">
                <div class="w3-tag w3-round w3-green w3-border w3-border-white">
                  {{ item.presupuestoDisponible }}
                </div>
              </div>
            </div>
            <div class="w3-container" *ngIf="!item.disponible">
              <div class="w3-tag w3-round w3-red" style="padding: 3px">
                <div class="w3-tag w3-round w3-red w3-border w3-border-white">
                  {{ item.presupuestoDisponible }}
                </div>
              </div>
            </div>
          </td>

          <td>
            <div class="d-flex justify-content-center">
              <button
                (click)="onModalOrdenesCompraCedula(item.id)"
                class="btn btn-outline-info btn-sm me-1"
              >
                <i class="fa-duotone fa-cart-shopping"></i>
              </button>
              <custom-button-edit
                (edit)="
                  onModalEditar({ id: item.id, title: 'Editar Registro' })
                "
              ></custom-button-edit>
              <custom-button-delete
                (OnConfirm)="onDelete(item)"
              ></custom-button-delete>
            </div>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</ng-container>
